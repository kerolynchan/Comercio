<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedido Card√°pio</title>
<style>
  body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #ff69b4, #800080, #ff69b4);
  padding: 20px;
  min-height: 100vh;
  margin: 0;
}
  .section { background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  h2 { margin-top: 0; }
  .opcoes-lista { list-style: none; padding-left: 0; }
  .opcoes-lista li { margin-bottom: 10px; }
  .produto { margin-bottom: 10px; }
  .conteudo-produto { margin-left: 20px; display: none; }
  .total { font-weight: bold; font-size: 18px; margin-top: 20px; }
  button { padding: 10px 15px; background-color: #ff69b4; border: none; color: #fff; border-radius: 5px; cursor: pointer; }
  button:hover { background-color: #e055a1; }
  input[type="number"] { width: 100px; }
  header.title { background-color:#800080; padding:30px 15px; text-align:center; border-radius:10px; margin-bottom:20px; }
  header.title h1 { color:#fff; font-size:28px; margin:0; font-family:Arial, sans-serif; line-height:1.2; }
  .small-link { color:#ff69b4; font-weight:bold; text-decoration:none; }
  summary { cursor: pointer; font-weight:600; }
  .notes { font-size:14px; color:#555; margin-bottom:10px; }
  .flex-row { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
</style>

</head>
<body>

<!-- ====== T√çTULO PRINCIPAL ====== -->
<header class="title">
  <h1>
    CARD√ÅPIO, PANFLETOS E ARTES PROMOCIONAIS<br>
    PARA SEU ESTABELECIMENTO
  </h1>
</header>

<!-- ====== FORMUL√ÅRIO ====== -->
<form id="pedidoForm">

  <!-- ====== DADOS DO CLIENTE ====== -->
  <section class="section">
    <h2>Dados do Cliente</h2>
    <p>Seu Nome:
      <input type="text" name="Nome" placeholder="Ex: Kerolyn" required>
    </p>
    <p>Nome da Empresa:
      <input type="text" name="Nome_Empresa" placeholder="Ex: KerolynChan" required>
    </p>
  </section>

  <!-- ====== DADOS DA EMPRESA ====== -->
  <section class="section">
    <h2>Dados da Empresa</h2>
    <p>Contato da Empresa:
      <input type="tel" name="Contato" placeholder="Ex: +5521123456789">
    </p>
    <p>Redes Sociais da Empresa:
      <input type="text" name="Rede_Social" placeholder="Ex: @Kerolynchan ou link">
    </p>
    <p>J√° possui link de pedido?
      <input type="text" name="Link_Pedido" placeholder="Ex: link do iFood, WhatsApp...">
    </p>
    <p>Possui endere√ßo f√≠sico?
      <input type="text" name="Endereco_Fisico" placeholder="Rua, n√∫mero, bairro...">
    </p>
    <p>Mencionar hor√°rio de funcionamento?
      <input type="text" name="Horario_Funcionamento" placeholder="Ex: Seg-Sex 8h √†s 18h">
    </p>
  </section>

  <!-- ====== RAMO DE VENDA ====== -->
  <section class="section">
    <h2>Qual seu Ramo de Venda?</h2>
    <select name="Ramo_Venda" required>
      <option value="">Selecione...</option>
      <option value="Doceria">Doceria</option>
      <option value="Confeitaria">Confeitaria</option>
      <option value="Padaria">Padaria</option>
      <option value="Cafeteria">Cafeteria</option>
      <option value="Pizzaria">Pizzaria</option>
      <option value="Hamburgueria">Hamburgueria</option>
      <option value="Lanchonete">Lanchonete</option>
      <option value="Restaurante de comida caseira">Restaurante de comida caseira</option>
      <option value="Restaurante japon√™s">Restaurante japon√™s</option>
      <option value="Restaurante chin√™s">Restaurante chin√™s</option>
      <option value="Restaurante √°rabe">Restaurante √°rabe</option>
      <option value="Food truck">Food truck</option>
      <option value="Marmitaria">Marmitaria</option>
      <option value="Churrascaria">Churrascaria</option>
      <option value="Sorveteria">Sorveteria</option>
      <option value="A√ßaiteria">A√ßaiteria</option>
      <option value="Bar">Bar</option>
      <option value="Adega">Adega</option>
      <option value="Distribuidora de bebida">Distribuidora de bebida</option>
      <option value="Loja de milkshake">Loja de milkshake</option>
      <option value="Quiosque">Quiosque</option>
      <option value="Buffet">Buffet</option>
      <option value="Fornecedor de doce para festa">Fornecedor de doce para festa</option>
      <option value="Fornecedor de salgado para festa">Fornecedor de salgado para festa</option>
      <option value="Fornecedor de salgado e doces para festa">Fornecedor de salgado e doces para festa</option>
      <option value="Loja de utilidade">Loja de utilidade</option>
      <option value="Artesanato">Artesanato</option>
      <option value="Floricultura">Floricultura</option>
      <option value="Petisco caseiro">Petisco caseiro</option>
      <option value="Mini-mercado">Mini-mercado</option>
      <option value="Pet Shop">Pet Shop</option>
      <option value="Casa de Ra√ß√£o">Casa de Ra√ß√£o</option>
    </select>

    <div class="flex-row" style="margin-top:10px;">
      <label><input type="checkbox" name="faz_entrega"> Fornecem entrega?</label>
    </div>

    <p>Deseja mencionar o pre√ßo da entrega?
      <input type="text" name="Mencionar_Preco" placeholder="R$">
    </p>
    <p>Descri√ß√£o curta do seu ramo:
      <input type="text" name="Descricao_curta" placeholder="Ex: Confeitaria artesanal">
    </p>
  </section>

  <!-- ====== IDENTIDADE VISUAL ====== -->
  <section class="section">
    <h2>Identidade Visual</h2>

    <details>
      <summary>J√° possui logotipo? (clique para escolher)</summary>
      <div class="logotipo-opcoes" style="margin-top:10px; padding-left:15px;">
        <label><input type="radio" name="Logo" value="sim" data-preco="0"> Sim ‚Äî vou enviar</label><br>
        <label><input type="radio" name="Logo" value="simples" data-preco="15"> Comprar um simples ‚Äî R$15,00</label><br>
        <label><input type="radio" name="Logo" value="flat" data-preco="30"> Comprar um logo com personagem flat design ‚Äî R$30,00</label><br>
        <label><input type="radio" name="Logo" value="cartoon" data-preco="80"> Comprar um logo com cartoon ‚Äî R$80,00</label><br>
        <label><input type="radio" name="Logo" value="cartoonHQ" data-preco="75"> Comprar um logo cartoon HQ ‚Äî R$75,00</label><br>
        <label><input type="radio" name="Logo" value="pixel" data-preco="40"> Comprar um logo pixel arte ‚Äî R$40,00</label><br>
        <label><input type="radio" name="Logo" value="anime" data-preco="90"> Comprar um logo anime ‚Äî R$90,00</label><br>
        <label><input type="radio" name="Logo" value="pogo" data-preco="60"> Comprar um pogo chibi ‚Äî R$60,00</label>
      </div>
    </details>

    <p>Fundo do card√°pio?
      <select name="Fundo_Cardapio" required>
        <option value="">Selecione...</option>
        <option value="cor_estatica">Cor est√°tica</option>
        <option value="cor_degrade">Cor degrad√™</option>
        <option value="imagem">Imagem</option>
        <option value="loop_visual">Loop visual (ex: brilhando, v√≠deo em movimento)</option>
      </select>
    </p>

    <p>Cores principais:
      <input type="text" name="Cor_Principal" placeholder="Ex: rosa #ff69b4, roxo #b027cc">
    </p>

    <p>
      üìé Envie seu logotipo manualmente pelo
      <a class="small-link" href="https://wa.me/5521978046832?text=Ol√°%2C%20vou%20enviar%20meu%20logotipo." target="_blank">WhatsApp</a>
    </p>

  </section>

  <!-- ====== FORMATO DE ENTREGA ====== -->
  <section class="section">
    <h2>üì¶ Formato de Entrega do Card√°pio</h2>
    <fieldset>
      <legend>Escolha um formato (apenas 1)</legend>
      <ul class="opcoes-lista">
        <li><label><input type="radio" name="formatoEntrega" value="post" data-itens="1" required> üì∑ Post (R$15, at√© 1 item)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="stories" data-itens="3"> üì± Stories (R$30, at√© 3 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="panfletoSimples" data-itens="5"> üì∞ Panfleto Simples (R$40, at√© 5 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="whatsapp" data-itens="8"> üí¨ Formul√°rio WhatsApp (R$50, at√© 8 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="panfletoCompleto" data-itens="12"> üì∞‚ú® Panfleto Completo (R$80, at√© 12 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="pdf" data-itens="14"> üìÑ Card√°pio PDF (R$90, at√© 14 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="html" data-itens="15"> üíª Card√°pio HTML (R$100, at√© 15 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="link" data-itens="17"> üîó Card√°pio Digital Link (R$130, at√© 17 itens)</label></li>
        <li><label><input type="radio" name="formatoEntrega" value="website" data-itens="20"> üåê Website (R$400, at√© 20 itens)</label></li>
      </ul>
    </fieldset>
  </section>

  <!-- ====== PRODUTOS ====== -->
  <section class="section" id="produtosSection" style="display:none;">
    <p>
      üìé Envie as imagens dos produtos manualmente (Ex: Produto 1 FOTO, Produto 2 FOTO, ...) pelo
      <a class="small-link" href="https://wa.me/5521978046832" target="_blank">WhatsApp</a>
    </p>

    <p class="notes">
      ‚ö†Ô∏è Observa√ß√£o: voc√™ pode adicionar de <b>1 produto</b> at√© a quantidade informada no formato escolhido.
      √â necess√°rio preencher todos os produtos sem sobrar espa√ßo em bran√ßo, caso nao queira mais produtos escreva (mada) em todos os campos.
    </p>

    <h2>Descreva seus Produtos do CARD√ÅPIO</h2>
    <div id="produtosContainer"></div>

    <!-- Op√ß√£o de adicionar extras -->
    <p>
      <label><input type="checkbox" id="addExtras"> Adicionar mais 5 produtos extras (+R$40)</label>
    </p>
    <p class="notes">‚ö†Ô∏è Observa√ß√£o: voc√™ pode adicionar <b>5 produto</b> a mais no mesmo formato de entrega.</p>
    <div id="extrasContainer" style="display:none;"></div>

    <!-- Op√ß√£o de adicionar unit√°rios -->
    <p style="margin-top:10px;">Adicionar produtos extras unit√°rios (+R$15 cada):</p>
    <div id="extrasUnitarios" style="display:flex; gap:15px; flex-wrap:wrap;">
      <label><input type="checkbox" class="singleExtraToggle" data-index="1"> +1 Produto</label>
      <label><input type="checkbox" class="singleExtraToggle" data-index="2"> +1 Produto</label>
      <label><input type="checkbox" class="singleExtraToggle" data-index="3"> +1 Produto</label>
      <label><input type="checkbox" class="singleExtraToggle" data-index="4"> +1 Produto</label>
      <label><input type="checkbox" class="singleExtraToggle" data-index="5"> +1 Produto</label>
    </div>

    <p class="notes">‚ö†Ô∏è Observa√ß√£o: Voc√™ pode adicionar <b>1 produto</b> a mais no estilo Post ou no mesmo estilo j√° selecionado.</p>
    <div class="flex-row">
      <label><input type="radio" name="extraProduto" value="post"> üì∑ Post</label>
      <label><input type="radio" name="extraProduto" value="mesmo"> Manter Estilo j√° Selecionado</label>
    </div>

    <div id="singleExtrasContainer"></div>
  </section>

  <p class="total">Total: R$ <span id="totalValor">0.00</span></p>
  <button type="submit">Enviar Pedido</button>

</form>

<script>
/*
  Arquivo corrigido e robusto:
  - Remove duplica√ß√£o de <body> / <form>
  - N√£o usa inputs de upload dentro do form (usu√°rio envia imagens manual pelo WhatsApp)
  - Corrige manipula√ß√£o de DOM e c√°lculos
  - Monta mensagem organizada e leg√≠vel para WhatsApp
*/

window.addEventListener('DOMContentLoaded', () => {
  const produtosContainer = document.getElementById('produtosContainer');
  const produtosSection = document.getElementById('produtosSection');
  const extrasContainer = document.getElementById('extrasContainer');
  const addExtrasCheckbox = document.getElementById('addExtras');
  const singleExtrasContainer = document.getElementById('singleExtrasContainer');
  const totalSpan = document.getElementById('totalValor');
  const form = document.getElementById('pedidoForm');

  let total = 0;

  // Valores dos formatos
  const formatoValores = {
    post: 15,
    stories: 30,
    panfletoSimples: 40,
    whatsapp: 50,
    panfletoCompleto: 80,
    pdf: 90,
    html: 100,
    link: 130,
    website: 400
  };

  // Quando escolhe formato, mostra produtos
  function bindFormatoListeners() {
    document.querySelectorAll('input[name="formatoEntrega"]').forEach(radio => {
      radio.addEventListener('change', function(){
        const qtd = parseInt(this.dataset.itens, 10) || 0;
        produtosContainer.innerHTML = '';
        produtosSection.style.display = 'block';
        for(let i=1;i<=qtd;i++){
          criaProduto(produtosContainer, i, false);
        }
        // esconder extras (reset) quando muda formato
        extrasContainer.innerHTML = '';
        extrasContainer.style.display = 'none';
        document.querySelectorAll('.singleExtraToggle').forEach(cb=> cb.checked = false);
        singleExtrasContainer.innerHTML = '';
        addExtrasCheckbox.checked = false;
        atualizaTotal();
      });
    });
  }

  // Listener extras de 5
  addExtrasCheckbox.addEventListener('change', function(){
    extrasContainer.innerHTML = '';
    if(this.checked){
      extrasContainer.style.display = 'block';
      for(let i=1;i<=5;i++){
        criaProduto(extrasContainer, 'extra'+i, true);
      }
    } else {
      extrasContainer.style.display = 'none';
    }
    atualizaTotal();
  });

  // Listener extras unit√°rios (5 checkboxes que adicionam 1 produto cada)
  function bindSingleExtraToggles(){
    document.querySelectorAll('.singleExtraToggle').forEach(cb=>{
      cb.addEventListener('change', function(){
        const idx = this.dataset.index;
        if(this.checked){
          criaProduto(singleExtrasContainer, 'single'+idx, true);
        } else {
          // remove
          const node = document.getElementById('produto-single'+idx);
          if(node) node.remove();
        }
        atualizaTotal();
      });
    });
  }

  // Fun√ß√£o para criar produto ‚Äî id pode ser number or string (ex: 'extra1', 'single2')
function criaProduto(container, id, extra){
  // label leg√≠vel
  let label = (extra ? 'Extra ' : '') + String(id);
  const elementId = 'produto-'+String(id);
  // se j√° existe, n√£o cria duplicado
  if(document.getElementById(elementId)) return;

  const div = document.createElement('details');
  div.className = 'produto';
  div.id = elementId;

  div.innerHTML = `
    <summary>üçî Produto ${label}</summary>
    <div class="conteudo-produto">
      <p>Produto: <input type="text" name="produto${id}" required></p>
      <p>Descri√ß√£o: <input type="text" name="descricao${id}"></p>
      <p>Pre√ßo:
      <input type="text" name="seupre√ßo" placeholder="Ex: R$1,99" required>
    </p>
      <p><label><input type="checkbox" name="promocao${id}" class="promocao"> Este produto √© uma promo√ß√£o</label></p>
      <p><label><input type="checkbox" class="artePromo"> Criar ARTE PROMOCIONAL (+R$10)</label></p>
    </div>
  `;
  container.appendChild(div);

  // toggle de exibi√ß√£o
  const conteudo = div.querySelector('.conteudo-produto');
  div.addEventListener('toggle', ()=>{ conteudo.style.display = div.open ? 'block':'none'; });

  // N√ÉO adicionamos listener do campo "preco" para o atualizaTotal()
  // (o pre√ßo do produto √© apenas informativo e n√£o conta no total do servi√ßo)

  // apenas bind para a checkbox de arte promocional (essa S√ç entra no total)
  const artePromoCb = div.querySelector('.artePromo');
  if(artePromoCb){
    artePromoCb.addEventListener('change', atualizaTotal);
  }
}

// Atualiza quando trocar o logotipo
function bindLogoListeners(){
  document.querySelectorAll('input[name="Logo"]').forEach(radio=>{
    radio.addEventListener('change', atualizaTotal);
  });
}

function atualizaTotal(){
  let soma = 0;

  // Formato selecionado
  const formatoSelecionado = document.querySelector('input[name="formatoEntrega"]:checked');
  if(formatoSelecionado) soma += formatoValores[formatoSelecionado.value] || 0;

  // Logotipo selecionado
  const logoSelecionado = document.querySelector('input[name="Logo"]:checked');
  if(logoSelecionado) soma += parseFloat(logoSelecionado.dataset.preco || 0);

  // NOTA: removido aqui a soma dos pre√ßos individuais dos produtos.
  // O campo pre√ßo dos produtos √© s√≥ informativo (vai pro WhatsApp) e N√ÉO entra no c√°lculo.

  // Artes promocionais (+R$10 cada) ‚Äî conta em qualquer container
  document.querySelectorAll('#produtosContainer .artePromo, #extrasContainer .artePromo, #singleExtrasContainer .artePromo').forEach(cb=>{
    if(cb.checked) soma += 10;
  });

  // Pacote de 5 extras (+R$40 se marcado)
  if(addExtrasCheckbox.checked) soma += 40;

  // Extras unit√°rios (+R$15 por checkbox marcada)
  const singleChecked = document.querySelectorAll('.singleExtraToggle:checked').length;
  if(singleChecked) soma += singleChecked * 15;

  total = soma;
  totalSpan.textContent = total.toFixed(2);
}

  // Monta mensagem e envia para WhatsApp
  function enviarWhatsApp(e) {
    e.preventDefault();

    // atualiza total antes
    atualizaTotal();

    const fd = new FormData(form);

    let mensagem = "üìã *Novo Pedido de Card√°pio*\n\n";

    // Dados do cliente
    mensagem += "üë§ *Dados do Cliente*\n";
    if(fd.get('Nome')) mensagem += `‚ñ´Ô∏è Nome: ${fd.get('Nome')}\n`;
    if(fd.get('Nome_Empresa')) mensagem += `‚ñ´Ô∏è Empresa: ${fd.get('Nome_Empresa')}\n`;
    mensagem += "\n";

    // Dados da empresa
    mensagem += "üè™ *Dados da Empresa*\n";
    if(fd.get('Contato')) mensagem += `üìû Contato: ${fd.get('Contato')}\n`;
    if(fd.get('Rede_Social')) mensagem += `üåê Redes sociais: ${fd.get('Rede_Social')}\n`;
    if(fd.get('Link_Pedido')) mensagem += `üîó Link pedido: ${fd.get('Link_Pedido')}\n`;
    if(fd.get('Endereco_Fisico')) mensagem += `üìç Endere√ßo: ${fd.get('Endereco_Fisico')}\n`;
    if(fd.get('Horario_Funcionamento')) mensagem += `‚è∞ Hor√°rio: ${fd.get('Horario_Funcionamento')}\n`;
    mensagem += "\n";

    // Ramo
    mensagem += "üç¥ *Ramo de Venda*\n";
    if(fd.get('Ramo_Venda')) mensagem += `‚ñ´Ô∏è Ramo: ${fd.get('Ramo_Venda')}\n`;
    if(fd.get('Descricao_curta')) mensagem += `üìù Descri√ß√£o: ${fd.get('Descricao_curta')}\n`;
    if(fd.get('Mencionar_Preco')) mensagem += `üí≤ Pre√ßo entrega: ${fd.get('Mencionar_Preco')}\n`;
    mensagem += "\n";

    // Identidade visual
    mensagem += "üé® *Identidade Visual*\n";
    const logoSel = document.querySelector('input[name="Logo"]:checked');
    if(logoSel) mensagem += `üñºÔ∏è Logotipo: ${logoSel.value} (R$${logoSel.dataset.preco || 0})\n`;
    if(fd.get('Fundo_Cardapio')) mensagem += `üé≠ Fundo: ${fd.get('Fundo_Cardapio')}\n`;
    if(fd.get('Cor_Principal')) mensagem += `üåà Cores: ${fd.get('Cor_Principal')}\n`;
    mensagem += "\n";

    // Formato
    mensagem += "üìê *Formato de Entrega*\n";
    const formato = document.querySelector('input[name="formatoEntrega"]:checked');
    if(formato) mensagem += `üì¶ ${formato.value} (R$${formatoValores[formato.value] || 0})\n`;
    mensagem += "\n";

    // Fun√ß√£o para coletar produtos
    function coletaProdutos(container){
      const lista = [];
      container.querySelectorAll('.produto').forEach((detail) => {
        const nome = detail.querySelector('input[name^="produto"]')?.value || '';
        const desc = detail.querySelector('input[name^="descricao"]')?.value || '';
        const preco = detail.querySelector('input[name^="preco"]')?.value || '';
        const promocao = detail.querySelector('input[name^="promocao"]')?.checked ? '‚úÖ Sim' : '‚ùå N√£o';
        const arte = detail.querySelector('.artePromo')?.checked ? 'üé® Sim' : '‚ùå N√£o';
        lista.push({nome, desc, preco, promocao, arte});
      });
      return lista;
    }

    // Produtos principais
    const produtosMain = coletaProdutos(produtosContainer);
    if(produtosMain.length){
      mensagem += "üçî *Produtos*\n";
      produtosMain.forEach((p,i)=>{
        mensagem += `\nüîπ *Produto ${i+1}*\n`;
        mensagem += `   ‚Ä¢ Nome: ${p.nome || '(sem nome)'}\n`;
        mensagem += `   ‚Ä¢ Descri√ß√£o: ${p.desc || '(sem descri√ß√£o)'}\n`;
        mensagem += `   ‚Ä¢ Pre√ßo: R$ ${p.nome || '(seupre√ßo)'}\n`;
        mensagem += `   ‚Ä¢ Promo√ß√£o: ${p.promocao}\n`;
        mensagem += `   ‚Ä¢ Arte Promocional: ${p.arte}\n`;
      });
      mensagem += "\n";
    }

    // Pacote de 5 extras
    const extrasPack = coletaProdutos(extrasContainer);
    if(extrasPack.length){
      mensagem += "‚ûï *Pacote 5 Extras* (R$40)\n";
      extrasPack.forEach((p,i)=>{
        mensagem += `\nüî∏ *Extra ${i+1}*\n`;
        mensagem += `   ‚Ä¢ Nome: ${p.nome || '(sem nome)'}\n`;
        mensagem += `   ‚Ä¢ Descri√ß√£o: ${p.desc || '(sem descri√ß√£o)'}\n`;
        mensagem += `   ‚Ä¢ Pre√ßo: R$ ${p.preco || '0.00'}\n`;
        mensagem += `   ‚Ä¢ Promo√ß√£o: ${p.promocao}\n`;
        mensagem += `   ‚Ä¢ Arte Promocional: ${p.arte}\n`;
      });
      mensagem += "\n";
    }

    // Extras unit√°rios
    const singleExtras = coletaProdutos(singleExtrasContainer);
    if(singleExtras.length){
      mensagem += "‚ûï *Extras Unit√°rios* (R$15 cada)\n";
      singleExtras.forEach((p,i)=>{
        mensagem += `\nüî∏ *Extra Unit√°rio ${i+1}*\n`;
        mensagem += `   ‚Ä¢ Nome: ${p.nome || '(sem nome)'}\n`;
        mensagem += `   ‚Ä¢ Descri√ß√£o: ${p.desc || '(sem descri√ß√£o)'}\n`;
        mensagem += `   ‚Ä¢ Pre√ßo: R$ ${p.preco || '0.00'}\n`;
        mensagem += `   ‚Ä¢ Promo√ß√£o: ${p.promocao}\n`;
        mensagem += `   ‚Ä¢ Arte Promocional: ${p.arte}\n`;
      });
      mensagem += "\n";
    }

    // Total
    mensagem += `üí∞ *Total Geral*: R$ ${total.toFixed(2)}\n`;

    // Envia para o seu n√∫mero
    const telefone = '5521978046832';
    const url = 'https://wa.me/' + telefone + '?text=' + encodeURIComponent(mensagem);
    window.open(url, '_blank');
  }

  // bind inicial
  bindFormatoListeners();
  bindSingleExtraToggles();
  bindLogoListeners();

  // sempre atualiza total quando algo mudar globalmente (delegate)
  document.body.addEventListener('input', (ev) => {
    // atualiza quando pre√ßo mudar
    if(ev.target && ev.target.matches('input[type="number"]')) atualizaTotal();
    // atualiza quando algum text/checkbox pode influenciar (logo price, etc)
  });
  document.body.addEventListener('change', (ev) => {
    if(ev.target && (ev.target.matches('input[name="Logo"]') || ev.target.matches('input[name="formatoEntrega"]') || ev.target.matches('.artePromo') || ev.target.matches('.singleExtraToggle') || ev.target.matches('#addExtras'))) {
      atualizaTotal();
    }
  });

  // ligar envio do form
  form.addEventListener('submit', enviarWhatsApp);

  // execu√ß√£o inicial (caso j√° haja coisas marcadas)
  atualizaTotal();
});
</script>

</body>
</html>
